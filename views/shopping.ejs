<!DOCTYPE html> 
<html lang="en">

<head>
    <%- include('partials/head') %>
</head>

<body class="bg-white text-black font-sans">
    <%- include('partials/header') %>

    <h1 class="font-bold text-xl m-10">
        Go Shopping For Books Notes & MCQS Papers
    </h1>

    <div class="grid gap-6 p-4 grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 auto-rows-auto">
        <% if (products && products.length > 0) { %>
            <% products.forEach(product => { %>
                <div class="bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700">
                    <a href="id=<%= product._id %>">
                        <% 
                            let productImage = (product.variants && product.variants.length > 0 && product.variants[0].images.length > 0)
                                ? product.variants[0].images[0]
                                : 'default-image.jpg'; // Fallback image
                        %>
                        <img class="rounded-t-lg w-full object-cover h-52" src="<%= productImage %>" alt="<%= product.name %>" />
                    </a>
                    <div class="p-5">
                        <h5 class="text-lg font-semibold tracking-tight text-gray-900 dark:text-white">
                            <%= product.name.slice(0, 10) + "..." %>
                        </h5>
                        <p class="mt-2 text-sm text-gray-700 dark:text-gray-400">
                            <%= product.description.slice(0, 18) + "..." %>
                        </p>
                        <p class="my-3 text-xl font-bold text-gray-900 dark:text-white">Rs <%= product.price %></p>
                        <div class="flex items-center justify-between mt-4">
                            <button
                                class="free btn-xs text-white border-white bg-black hover:bg-gray-800 focus:ring-4 focus:outline-none focus:ring-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-800 add-in-bag"
                                data-product="<%= JSON.stringify(product) %>">
                                Add to Bag
                            </button>
                        </div>
                    </div>
                </div>
            <% }) %>
        <% } else { %>
            <p class="text-center text-gray-700 dark:text-gray-400">No products available.</p>
        <% } %>
    </div>

    <%- include('partials/footer') %>

    <script src="script.js"></script>
    <script src="shopping.js"></script>
</body>

</html>
